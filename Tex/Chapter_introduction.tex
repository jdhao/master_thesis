%!TEX root = ../Thesis.tex

\chapter{绪论}
\label{Chapter_introduction}

\section{引言}
本文的研究内容为基于内容的图像检索（content-based image retrieval，CBIR）。在计算机发展早期，由于拍照设备的昂贵与匮乏，图像数量相对较少，人们通常采用一些关键词来描述图像，在需要检索图像的时候，采用文本检索相关的关键词来找到对应的图像，这种方法称为基于文本的图像检索。这种基于文本的检索方式存在明显的缺点，一方面，这种方法的准确率依靠图像标注的准确度，而且图像的标注也十分耗时耗力，不同的人之间存在一定的主观性偏差；另外，图像中颜色以及纹理等信息也很难用文字精确地描述。从 20 世纪 90 年代以来，随着互联网和个人电脑的流行，以及拍照和存储设备的大量普及，数字图像出现井喷，通过人工对图像进行标注与管理，变得更加不现实与困难。为了克服基于文本的图像搜索的问题，高效地组织和检索这些图片，人们提出了基于内容的图像检索技术。

所谓基于内容的图像检索，通俗来说就是「以图搜图」，是把计算机视觉相关技术应用到图像检索中，利用计算机来自动提取图像的颜色，形状，纹理等信息或者更高层的图像语义信息，将这些信息表示为图像的特征，计算查询图像特征与数据中的图像特征的相似度，然后从图像库返回与查询的图像相似的图片。这里的「内容」指的是图像颜色，形状，纹理等可以从图像中直接得到的信息，而不是图像的标注信息等文本信息。这种技术的优点是无需人工描述图像内容，可以应用到大规模场景，只要图像的特征提取准确，就能保证很高的检索准确率。

从 1990 年到 2000 年的这十几年间，是 CBIR 技术的发展初期，相关研究者对基于内容的图像检索技术进行了大量的研究。在这一时期，研究者们使用的特征主要是图像的颜色直方图特征，纹理以及形状等比较简单的特征，同时，由于硬件以及算法的限制，相关的图像库通常比较简单，图片数量也相对较少。学术界和工业界也开发了一些早期的图像检索的系统，例如 PhotoBook~\cite{Pentland1996PhotobookCM}，QBIC~\cite{Niblack1993TheQP}，Virage~\cite{Bach1996VirageIS}，PicToSeek~\cite{Gevers2000PicToSeekCC} 等。

2000 年以后，随着 SIFT（scale invariant feature transform）~\cite{Lowe2004DistinctiveIF}局部特征特征描述子提取算法的提出，由于 SIFT 特征对图像的旋转，缩放以及光照的变化都有很好的鲁棒性，因而被大量使用，成为最流行的图像局部特征表示方法。之后，基于 SIFT 的视觉词袋（bag of features，BOF）模型被提出~\cite{Sivic2003VideoGA}。BOF 借鉴自文本检索领域的词袋模型，很好地利用了图像的局部特征，用一个特征向量编码了图像的信息，在检索任务上取得了不错的成绩。在这之后，有大量的基于 BOF 或者 SIFT 特征的检索方法出现~\cite{Philbin2008LostIQ,Philbin2007ObjectRW,Mikulk2010LearningAF,Arandjelovic2012ThreeTE,Chum2007TotalRA}，图像检索方法研究迎来又一波热潮。随着深度学习的兴起，深度卷积神经网络在计算机视觉各个领域都取得了大幅超越其他方法的结果，基于卷积神经网络的图像检索方法也大量涌现。在工业界，也出现了一些支持以图搜图的功能的图像搜索系统，国外的此类网站如 TinEye~\footnote{\url{https://www.tineye.com/}} 和 Google 图像搜索引擎\footnote{\url{https://images.google.com/}}，国内则有百度识图\footnote{\url{http://image.baidu.com/?fr=shitu}}以及搜狗图像搜索\footnote{\url{http://pic.sogou.com/}}等。

除了应用于通用的图像搜索引擎，基于内容的图像搜索技术在其他方面也有着非常广泛的应用：在医学领域，检索相同器官的 X 光照片；在社会公共安全及打击犯罪方面，检索嫌疑人的指纹以及面部信息等，确定数据库中是否有相关资料；在设计领域，设计师通过给出一些包含特定纹理以及颜色的照片，从数据库中或者互联网上寻找具有相似风格的照片；在电商购物网站，消费者希望通过服装或者商品的照片，从网站上找到同款或者相似的商品；在版权保护领域，版权所有人可以采用图像检索的技术查找自己的图片是否有被其他人未经授权使用。其他类型的应用还有很多，总的来说，基于内容的图像检索技术在实际生活中有着广泛的应用场景。

\section{研究背景及意义}
智能手机的流行给用户拍照带来了便利，拍照不再是专业摄影师的权力，随着时间的推移，用户们也累积了大量的个人照片，如何组织管理这些照片成为一个问题，基于图像检索的技术可以帮助用户对这些照片进行有效的聚类与管理。伴随着移动互联网时代的来临以及互联网服务接入的便利化，一些社交类的网站和应用，例如 Facebook， Twitter，Weibo， Wechat 等，以及图片视频分享网站和应用，如 Instagram，Flickr，YouTute，优酷等发展迅速。随之而来的是互联网产生的大量的多媒体内容（视频，图片，音频，文本等）。一些典型的社交应用每天产生的图片量十分惊人，例如，著名的图片分享应用 Instagram 大约会产生 5200 万张图片, Facebook 约为 3 亿张，在中国非常流行的微信则达到了 10 亿级别。随之而来的是，在社交平台上，敏感图片的散布也会造成不良的影响甚至严重的后果。很多 Facebook 用户会在个人账户或者一些群组上传一些枪支图片~\cite{Drange2016,MELE2016FacebookBG}，微博用户也在微博上散发一些暴力图片等，这些敏感图片需要适当的监管与处理，以避免引起严重后果，这些需求都可以使用图像检索技术的相关技术来满足。

近些年来，随着电脑硬件的不断进步，特别是图形处理器（graphics processing unit，GPU）的普及，以及诸如 ImageNet~\cite{Russakovsky2015ImageNetLS} 级别的大规模图像数据库的发布，使得深度神经网络的训练成为可能，基于深度学习的方法成为主流的机器学习方法。深度卷积神经网路是深度学习方法~\cite{lecun2015deep} 中常用的模型之一，卷积神经网络具有强大的数据表达能力，在图像分类，物体检测，图像分割，目标跟踪等领域都取得了巨大的成功。随着它的流行~\cite{Krizhevsky2012ImageNetCW}，研究者们也开始尝试把卷积神经网络与图像检索的技术结合，通过神经网络来直接提取具有区分性的图像特征，或者通过度量学习的方式，更新网络参数，学习图像的特征。这一领域的进展迅速，在短短几年时间内，现有的一些方法~\cite{Gordo2016DeepIR} 在图像检索常用数据集~\cite{Philbin2007ObjectRW,Philbin2008LostIQ,Nistr2006ScalableRW,Jgou2008HammingEA} 上的效果已经超越了传统的基于 SIFT 特征的视觉词袋模型等方法。

在本文中，我们研究基于深度卷积神经网络的图像检索技术。现有的一些基于神经网络的方法未能全面探索影响提取的特征有效性的因素，如何提升神经网络提取的图像特征的有效性仍然需要很多的研究，同时，图像检索依然面临着很多的挑战，例如算法不能有效处理图像中物体的视角和姿态的大幅度变化，复杂背景图像的干扰以及光照变化等都会造成图像检索算法准确度的下降。在当今的大数据时代，如何从海量的图片中找到相似的图片也对图像检索算法的速度提出了很高的要求。目前为止，这些问题都没有得到很好的解决，我们仍然需要研究更准确与更高效的算法来解决上述难题。

\section{论文的组织}
本文其它各章的组织如下：

第 \ref{chapter:overview_related_work}~章为图像检索相关方法的综述。该章先介绍了图像检索领域一些早期的工作，包括使用颜色，纹理特征的检索方法，然后我们介绍了基于 SIFT 局部特征描述子的方法，其中包含基于视觉词袋模型的方法以及基于 VLAD 和 Fisher Vector 的方法。最后我们介绍了卷积神经网络的一些基本概念，然后介绍了直接从已有的网络模型提取图像特征进行检索的方法以及对神经网络进行微调进行检索的方法。

第 \ref{chapter:firearm_dataset}~章介绍我们建立的大规模枪支图片数据库 Firearm14k。主要介绍了枪支图片的收集与清理过程，然后介绍了图片的标注，标注人员标注质量的评估以及图片的筛选过程。最后我们列出了数据库的一些特点，我们也展示了一些示例图片，介绍了数据库的划分（训练集，验证集，测试集）过程，给出了数据库的具体统计信息。

第 \ref{chapter:mfc}~章提出了一种多尺度全卷积的图像实例检索方法。我们先介绍了已有的一些利用卷积神经网络提取图像特征的方法没有详细研究的问题，然后详细介绍了影响神经网络提取的特征有效性的三个因素：输入图像尺寸的变化策略，多尺度特征表达，降维以及白化矩阵的学习。我们通过大量的实验确定了三个因素对特征有效性的影响，在此基础上我们提出了多尺度全卷积的图像实例检索方法。最后，我们在多个数据库进行了实验，实验结果表明我们提出的方法有着良好的检索性能。

第 \ref{chapter:double_margin}~章提出了一种基于双阈值对比损失函数的枪支图像检索方法。我们发现，将传统的基于单阈值对比损失函数的方法应用到枪支图像检索问题，不能取得很好的检索精度，一方面，这是由于在训练过程中，正负样本对产生的损失不平衡，另外一方面，这是由于 Firearm14k 数据库与 ImageNet 存在了很大差异。为了解决这些问题，我们提出使用双阈值对比损失函数，并结合两步训练的策略来微调神经网络模型。在该章，我们首先介绍了提出的方法，然后给出了一些对比实验的结果以及可视化的结果，最后，我们把提出的方法和当前主流方法进行了对比，实验结果表明我们的方法在不同的特征维度下都取得了很好的检索精度。

第 \ref{chapter:conclusion}~章对本文的研究工作做一总结，并对未来的研究方向进行了展望。
